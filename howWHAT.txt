data engg in 2 layers (in folder straucture ) of staging,datawarehouse (to make dimension tbales),datamart layer .
i have to make fact and dimension tables. suggest what to do in each layer according to the data
this is the naming scheme i will be using , given your structure. give me code how can i do to get this transformed_users.csv. 
in my opinion,lets create the userskillproficiency, courseskill,designationskill normalised tables in the dimension layer. it will be an added step to be able to show
define hierarchy in designations. 
data_engineering/
│
├── staging/
│   ├── raw/
│   │   ├── users.csv
│   │   ├── courses.csv
│   │   ├── designations.csv
│   │   ├── skills.csv
│   │   ├── progress.csv
│   │   ├── user_skills.csv
│   │   └── course_skills.csv
│   └── transformed/
│       ├── transformed_users.csv
│       ├── transformed_courses.csv
│       └── transformed_progress.csv
│
├── mart/
│   ├── dimension/
│   │   ├── dim_users.csv
│   │   ├── dim_courses.csv
│   │   ├── dim_designations.csv
│   │   ├── dim_skills.csv
│   │   └── dim_time.csv
│   ├── fact/
│   │   ├── fact_course_progress.csv 
├── reporting/
│       ├── mart_course_completion.csv
│       └── mart_user_skill.csv

do this for fact_course_progress.csv :
completion_rate = progress_df.groupby('courseId')['percentage_completed'].mean().reset_index()
courses_df = courses_df.merge(completion_rate, on='id', how='left')
courses_df.rename(columns={'percentage_completed': 'average_completion_rate'}, inplace=True)
progress_df['at_risk'] = (progress_df['percentage_completed'] < 50).astype(int)  # Flag users with less than 50% progress when the date of course assigned (first entry of that user with that course in progress table) has exceeded 15days
total courses completed per user,



for reporting and shit:
#average_duration_by_proficiency = courses_df.groupby('proficiency_level')['duration'].mean().reset_index()


#fact_course : avg rate of which users are completing this course. 
             : completed by all users (no user has this course active)

#fact user:total courses completed per user



